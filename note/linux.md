Linux 命令行一些简单常用的命令记录

# General

- `cd` change directory
- `pwd` 当前工作路径（dirname）
- `ls` 列出当前文件名
- `ll` 详细列出当前文件（ls -a）
- `ls -a` 列出当前所有文件名（包括.隐藏文件）
- `ll -a` 详细列出当前所有文件（包括.隐藏文件）
- `tree` 树形结构显示目录
- `uname` 操作系统名 （-a: 详情）
- `su` 切换用户
- `ifconfig` 查看网络情况
- `ping` 测试网络连通
- `netstat` 显示网络状态信息

# shell keyboard shortcuts

- `control + u` clear
- `control + w` 删除光标左边的单词
- `control + a` 移动光标到行首
- `control + e` 移动光标到行尾

# document

- `touch` 创建文件
- `rm` 删除文件
- `mkdir` 创建文件夹
- `rmdir` 删除空文件夹
- `rm -rf` 递归删除文件夹（包括文件）

# cat

- `-n` 显示行号
- `-b` 显示行号,空行不显示行号
- `-s` 连续两行以上的空白行，只显示一行

# more

按页查看，只允许你向前查看文件

- `-{num}` 显示行数
- `-b` 显示行号,空行不显示行号
- `-s` 连续两行以上的空白行，只显示一行
- `+num` 从第 num 行开始显示

|            交互指令 | 功能                         |
| ------------------: | :--------------------------- |
|             h 或 ？ | 显示 more 命令交互命令帮助。 |
|              q 或 Q | 退出 more                    |
|                   v | 在当前行启动一个编辑器       |
|                  :f | 显示当前文件的文件名和行号   |
| !<命令> 或 :!<命令> | 在子 Shell 中执行指定命令    |
|              回车键 | 向下移动一行                 |
|              空格键 | 向下移动一页                 |
|              Ctrl+l | 刷新屏幕                     |
|                   = | 显示当前行的行号             |
|                   ' | 转到上一次搜索开始的地方     |
|              Ctrl+f | 向下滚动一页                 |
|                   . | 重复上次输入的命令           |
|            / 字符串 | 搜索指定的字符串             |
|                   d | 向下移动半页                 |
|                   b | 向上移动一页                 |

# less

less 可以按键盘上下方向键显示上下文内容

- `-e` 当文件显示结束后，自动离开
- `-b` <缓冲区大小> 设置缓冲区的大小
- `-f` 强迫打开特殊文件，例如外围设备代号、目录和二进制文件
- `-g` 只标志最后搜索的关键词
- `-i` 忽略搜索时的大小写
- `-m` 显示类似 more 命令的百分比
- `-N` 显示每行的行号
- `-o` <文件名> 将 less 输出的内容在指定文件中保存起来
- `-Q` 不使用警告音
- `-s` 显示连续空行为一行
- `-S` 行过长时间将超出部分舍弃
- `-x <数字>` 将"tab"键显示为规定的数字空格

# grep

文本文件或管道数据流中筛选匹配的行和数据，允许正则匹配

- `-v` 排除结果
- `-n` 显示行号
- `-i` 不区分大小写
- `-c` 只统计行
- `-w` 只匹配过滤的单词
- `-o` 只输出匹配的内容

# ps

Process Status 用来列出系统当前运行的那些进程

- `a` 显示所有进程
- `-a` 显示同一终端下的所有程序
- `-A` 显示所有进程
- `c` 显示进程的真实名称
- `-N` 反向选择
- `-e` 等于“-A”
- `e` 显示环境变量
- `f` 显示程序间的关系
- `-H` 显示树状结构
- `r` 显示当前终端的进程
- `T` 显示当前终端的所有程序
- `u` 指定用户的所有进程
- `-au` 显示较详细的资讯
- `-aux` 显示所有包含其他使用者的行程
- `-C<命令>` 列出指定命令的状况
- `–lines<行数>` 每页显示的行数
- `–width<字符数>` 每页显示的字符数
- `–help` 显示帮助信息
- `–version` 显示版本显示

示例

```shell
ps -u root  # 显示指定用户 root 信息
ps -ef # 显示所有进程信息，连同命令行
ps -ef|grep ssh # ps 与grep 常用组合用法，查找特定进程
ps -l # 将目前属于您自己这次登入的 PID 与相关信息列示出来
ps aux # 列出目前所有的正在内存当中的程序
ps -axjf # 列出类似程序树的程序显示
```

# top

- `-d <秒数>`：指定 top 命令的刷新时间间隔，单位为秒。
- `-n <次数>`：指定 top 命令运行的次数后自动退出。
- `-p <进程ID>`：仅显示指定进程 ID 的信息。
- `-u <用户名>`：仅显示指定用户名的进程信息。
- `-H`：在进程信息中显示线程详细信息。
- `-i`：不显示闲置（idle）或无用的进程。
- `-b`：以批处理（batch）模式运行，直接将结果输出到文件。
- `-c`：显示完整的命令行而不截断。
- `-S`：累计显示进程的 CPU 使用时间。

示例

```shell
top -d 10 # 表示更新周期为 10 秒
top -n 2 # 表示更新两次后终止退出
top -p 139 # 显示进程号为139的进程信息，CPU、内存占用率等
```

交互命令

- `q` 退出程序
- `x` 高亮当前排序列
- `M` 根据驻留内存大小进行排序
- `P` 根据 CPU 使用百分比大小进行排序
- `shift + >`或`shift + <`可以向右或左改变排序列

# vim

## vim 查找/搜索

### / 或者? 搜索

在 Vim 普通模式下，输入 `/` 或 `?` 符号就进入了搜索模式，`/` 用于正向往下搜索，`?` 用于反向往上搜索。

### n/N 正反向下一个

在搜索模式下可以对 Vim 打开的整个文本内容进行搜索，当按下 `n` 时可以继续正向查找下一个相匹配的目前单词。`N` 的作用与 `n` 相反，是往上反向搜索目标单词。

### 光标处单词搜索

在 Vim 命令模式下，如果要搜索当前光标下的单词，除了可以使用`/` 和 `?` 外，还可以使用特殊命令`*` 和 `#`。

假设光标当前所有单词为 the，那么在当前光标位置执行命令 \* 相当于搜索命令 `/<the>`，命令 `#` 等同于命令 `?<the>`。

- `\<` 是一个单词定界符，表示只匹配单词的开头;
- `\>` 也是单词定界符，表示只匹配单词末尾。

注意：搜索一些特殊的字符，例如：\*、[、]、^、%、/、?、~、$等，需要在它们的前面加上转义符号\。

### Vim 高亮搜索

为了在 Vim 中高亮显示被搜索的字符，可以使用命令 `:set hlsearch`，可以在 Vim 命令行模式执行命令或者在配置文件 `.vimrc` 中进行永久设置。

如果需要清除最近一次的屏幕搜索高亮结果，可以在 Vim 命令行模式使用命令 `:nohlsearch` 或其缩写形式 `:noh`。

## vim 替换

`:[range]s/from/to/[flags]`

```shell
:1,10s/from/to/ # 表示在第1到第10行（包含第1，第10行）之间搜索替换
:10s/from/to/ # 表示只在第10行搜索替换
:%s/from/to/ # 表示在所有行中搜索替换
:1,$s/from/to/ # 同上
```

flags  
g/i

# User Management

- `/etc/passwd` path, 用户表
- `passwd` 修改密码
- `id` 查看用户信息

## useradd

- `-c<备注>`　加上备注文字。备注文字会保存在 passwd 的备注栏位中。
- `-d<登入目录>` 　指定用户登入时的起始目录。
- `-D` 　变更预设值．
- `-e<有效期限>` 　指定帐号的有效期限。
- `-f<缓冲天数>` 　指定在密码过期后多少天即关闭该帐号。
- `-g<群组>` 　指定用户所属的群组。
- `-G<群组>` 　指定用户所属的附加群组。
- `-m` 　制定用户的登入目录。
- `-M` 　不要自动建立用户的登入目录。
- `-n` 　取消建立以用户名称为名的群组．
- `-r` 　建立系统帐号。
- `-s<shell>`　 　指定用户登入后所使用的 shell。
- `-u<uid>` 　指定用户 ID。

## usermod

- `-c<备注>` 　修改用户帐号的备注文字。
- `-d登入目录>` 　修改用户登入时的目录。
- `-e<有效期限>` 　修改帐号的有效期限。
- `-f<缓冲天数>` 　修改在密码过期后多少天即关闭该帐号。
- `-g<群组>` 　修改用户所属的群组。
- `-G<群组>` 　修改用户所属的附加群组。
- `-l<帐号名称>` 　修改用户帐号名称。
- `-L` 　锁定用户密码，使密码无效。
- `-s<shell>` 　修改用户登入后所使用的 shell。
- `-u<uid>` 　修改用户 ID。
- `-U` 　解除密码锁定。

## `userdel

- `-r` 　删除用户登入目录以及目录中所有文件。

# Group Management

- `/etc/group` path, 用户组表

## groupadd

- `-g`：指定新建工作组的 id；
- `-r`：创建系统工作组，系统工作组的组 ID 小于 500；
- `-K`：覆盖配置文件 /etc/login.defs；
- `-o`：允许添加组 ID 号不唯一的工作组。
- `-f,--force`: 如果指定的组已经存在，此选项将失明了仅以成功状态退出。当与 -g 一起使用，并且指定的 GID_MIN 已经存在时，选择另一个唯一的 GID（即 -g 关闭）。

## groupdel

(无)

## User Operations

```shell
$ usermod -aG hr user01  #  把 user01 添加到 hr 组   -a 参数表示追加
$ gpasswd  -a hr user01  #  把 user01 添加到 hr 组
$ gpasswd  -d hr user01  #  把 user01 从 hr 组移除
```

增删组更直接的操作, 修改`/etc/group`

# File Authority

### chmod

`chmod [ugoa][=+-][rwx] [file/directory]`

```shell
chmod u=rwx/home/hello.txt #给所属用户赋予读写执行的权限
chmod g+r /home/hello.txt # 给所属组增加读权限
chmod o+r /home/hello.txt #给其他用户增加读权限
chmod a-X /home/hello.txt  #给所有用户去除执行权限
# 同时修改多个的方式:
chmod u=rwx,g+r,a-x/home/hello.txt
```

`chmod [0-7][0-7][0-7] [file/directory]`
r=5  
w=2  
x=1

```shell
chmod 777 /home/hello.txt # rwx|rwx|rwx
chmod 600 /home/hello.txt # r-x|---|---
chmod 555 /home/hello.txt # r--|r--|r--
```
